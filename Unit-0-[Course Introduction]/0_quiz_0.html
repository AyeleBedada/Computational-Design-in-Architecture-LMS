<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Unit 0 - Course Introduction</title>
    <link rel="stylesheet" href="../css/style.css">
    <style>
        /* Dropdown menu styles */
        .dropdown {
            position: relative;
            display: inline-block;
        }
        .dropdown-content {
            display: none;
            position: absolute;
            background-color: #78bb7b;
            min-width: 200px;
            z-index: 1000;
            padding: 0;
            margin: 0;
            border-radius: 5px;
        }
        .dropdown-content a {
            color: #000;
            padding: 0.5rem 1rem;
            display: block;
        }
        .dropdown:hover .dropdown-content {
            display: block;
        }
        .dropdown-content a:hover {
            background-color: #2ea15a;
            color: #fff;
        }
    </style>
</head>
<body>
<div class="main-wrapper">

    <!-- Sidebar -->
    <aside class="sidebar">
        <h2>Course Units</h2>
        <ul id="sidebar-menu">
            <li class="dropdown">
                <span>Unit 0</span>
                <ul class="dropdown-content">
                    <li><a href="0_quiz_0.html">Course Introduction Quiz</a></li>
                </ul>
            </li>
            <li class="dropdown">
                <span>Unit 1</span>
                <ul class="dropdown-content">
                    <li><a href="../Unit-1.1.1_introduction_Computational_Design/1.1.1_introduction_Computational_Design.html">1.1.1 Introduction to Computational Design</a></li>
                    <li><a href="../Unit-1.2_handles_Manipulators/1.2_handles_Manipulators.html">1.2 Handles & Manipulators</a></li>
                </ul>
            </li>
            <li class="dropdown">
                <span>Unit 2</span>
                <ul class="dropdown-content">
                    <li><a href="../Unit-2.1_contemporary_Geometries/2.1_contemporary_Geometries.html">2.1 Contemporary Geometries</a></li>
                </ul>
            </li>
            <li class="dropdown">
                <span>Unit 3</span>
                <ul class="dropdown-content">
                    <li><a href="../Unit-3.1_digital_fabrication/3.1_digital_fabrication.html">3.1 Digital Fabrication</a></li>
                </ul>
            </li>
            <li class="dropdown">
                <span>Unit 4</span>
                <ul class="dropdown-content">
                    <li><a href="../Unit-4.1_introduction_BIM/4.1_introduction_BIM.html">4.1 Introduction to BIM</a></li>
                </ul>
            </li>
            <li class="dropdown">
                <span>Final Assessments</span>
                <ul class="dropdown-content">
                    <li><a href="../post_course_assessment.html">Post Course Assessment</a></li>
                    <li><a href="../complete.html">Course Completion</a></li>
                </ul>
            </li>
            <li id="admin-link" style="display:none;">
                <a href="../admin.html">Admin Dashboard</a>
            </li>
        </ul>
    </aside>

    <!-- Main Content -->
    <div class="content">
        <!-- Top menu -->
        <nav class="topnav">
            <span>Computational Design LMS</span>
            <div>
                <div class="dropdown">
                    <a href="#">Units</a>
                    <div class="dropdown-content">
                        <a href="0_quiz_0.html">Unit 0 - Quiz</a>
                        <a href="../Unit-1.1.1_introduction_Computational_Design/1.1.1_introduction_Computational_Design.html">Unit 1.1.1</a>
                        <a href="../Unit-1.2_handles_Manipulators/1.2_handles_Manipulators.html">Unit 1.2</a>
                        <a href="../Unit-2.1_contemporary_Geometries/2.1_contemporary_Geometries.html">Unit 2.1</a>
                        <a href="../Unit-3.1_digital_fabrication/3.1_digital_fabrication.html">Unit 3.1</a>
                        <a href="../Unit-4.1_introduction_BIM/4.1_introduction_BIM.html">Unit 4.1</a>
                    </div>
                </div>
                <div class="dropdown">
                    <a href="#">Assessments</a>
                    <div class="dropdown-content">
                        <a href="../post_course_assessment.html">Post Course Assessment</a>
                        <a href="../complete.html">Course Completion</a>
                    </div>
                </div>
                <a href="../profile.html">Profile</a>
                <a href="../index.html" id="logout-btn">Logout</a>
                <a href="../admin.html" id="admin-top-link" style="display:none;">Admin</a>
            </div>
        </nav>

        <h1>Unit 0 - Course Introduction</h1>
        <div id="quiz-container"></div>

        <!-- Forum -->
        <div class="forum-container">
            <h3>Forum</h3>
            <div id="0_quiz_0-forum-messages"></div>
            <input type="text" id="forum-input" placeholder="Write a message...">
            <button id="forum-submit">Post</button>
        </div>

        <!-- Progress -->
        <h3>Your Progress</h3>
        <div class="progress-line-wrapper">
            <div class="progress-fill">0%</div>
        </div>
        <div class="circular-progress">
            <svg width="80" height="80">
                <circle class="bg" cx="40" cy="40" r="45"></circle>
                <circle class="progress" cx="40" cy="40" r="45"></circle>
            </svg>
        </div>
        <div class="stepped-progress">
            <div class="step"></div>
            <div class="step"></div>
            <div class="step"></div>
            <div class="step"></div>
        </div>
    </div>
</div>

<script src="../js/auth.js"></script>
<script src="../js/forum.js"></script>
<script src="../js/progress.js"></script>
<script src="../js/quiz.js"></script>
<script>
document.addEventListener('DOMContentLoaded', () => {
    const session = AUTH.getSession();
    if (!session) {
        window.location.href = "../index.html";
        return;
    }

    // Show admin links if user is admin
    if (session.role === 'admin') {
        document.getElementById('admin-link').style.display = 'block';
        document.getElementById('admin-top-link').style.display = 'inline-block';
    }

    const quizId = '0_quiz_0';
    const container = document.getElementById('quiz-container');
    QUIZ.initQuizPage(container, quizId);

    // Forum
    const forumInput = document.getElementById('forum-input');
    const forumSubmit = document.getElementById('forum-submit');
    forumSubmit.addEventListener('click', () => {
        FORUM.post(quizId, forumInput.value);
        forumInput.value = '';
    });

    // Logout
    document.getElementById('logout-btn').addEventListener('click', () => {
        AUTH.logout();
        window.location.href = "../index.html";
    });

    // Initialize progress if exists
    const savedScore = parseInt(localStorage.getItem(`best_${quizId}_${session.username}`)) || 0;
    const total = (JSON.parse(localStorage.getItem(quizId)) || []).length;
    UIProgress.updateAllProgress(savedScore, total);
});
</script>
</body>
</html>
