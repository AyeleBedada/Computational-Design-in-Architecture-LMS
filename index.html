<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Computational Design — Login</title>
  <link rel="stylesheet" href="css/style.css" />
  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/emailjs-com@3/dist/email.min.js"></script>
  <!-- Firebase -->
  <script src="https://www.gstatic.com/firebasejs/9.25.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/9.25.0/firebase-firestore-compat.js"></script>
  <script src="config/firebase-config.js"></script>
  <script>
    // initialize EmailJS - public key from your message
    (function(){
      if(window.emailjs){ emailjs.init('zpLGGHu-3-PeFLptL'); }
    })();
  </script>
</head>
<body class="login-page" oncontextmenu="return false;">
  <main class="login-wrap" id="login-wrap">
    <header class="brand">
      <img src="assets/logo.png" alt="Logo" class="logo" onerror="this.style.display='none'"/>
      <h1>Computational Design — Learning Hub</h1>
      <p>Welcome. Please sign in to continue.</p>
    </header>

    <section class="login-card">
      <form id="loginForm" autocomplete="off" novalidate>
        <label>
          Email
          <input id="email" type="email" name="email" required />
        </label>
        <label>
          Password
          <input id="password" type="password" name="password" required />
        </label>

        <div class="small-actions">
          <button type="button" id="sendCodeBtn">Send Login Code</button>
          <button type="submit" id="loginBtn">Login</button>
        </div>

        <div class="muted">
          <a href="#" id="forgotLink">Forgot / Change password</a>
        </div>

        <div id="loginFeedback" class="feedback"></div>
      </form>
    </section>

    <footer class="login-foot">
      <p>Course: Computational Design in Architecture — accessible & modern.</p>
    </footer>
  </main>

  <script src="js/auth.js"></script>
  <script>
    // safety: prevent copying and (attempt) to block PrintScreen for non-admins
    document.addEventListener('keydown', (e) => {
      if(!window.currentUser || window.currentUser.role !== 'admin') {
        if (e.key === 'PrintScreen') { e.preventDefault(); navigator.clipboard && navigator.clipboard.writeText(''); }
        if ((e.ctrlKey && e.key === 'c') || (e.ctrlKey && e.key === 'p')) e.preventDefault();
      }
    });
    document.addEventListener('copy', (e) => {
      if(!window.currentUser || window.currentUser.role !== 'admin') e.preventDefault();
    });
  </script>
</body>
</html>
